{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "toast",
  "title": "Toast",
  "description": "Temporary notification messages that appear briefly to provide non-intrusive feedback.",
  "dependencies": ["@base-ui/react", "lucide-react"],
  "files": [
    {
      "path": "packages/ui/src/toast.tsx",
      "content": "\"use client\";\n\nimport { Toast } from \"@base-ui/react/toast\";\nimport {\n  CircleCheckIcon,\n  InfoIcon,\n  Loader2Icon,\n  OctagonXIcon,\n  TriangleAlertIcon,\n  XIcon,\n} from \"lucide-react\";\nimport { type CSSProperties, isValidElement, type ReactNode } from \"react\";\n\nimport { cn } from \"./utils\";\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\ntype ToastPosition =\n  | \"top-left\"\n  | \"top-center\"\n  | \"top-right\"\n  | \"bottom-left\"\n  | \"bottom-center\"\n  | \"bottom-right\";\n\ninterface ToastAction {\n  label: ReactNode;\n  onClick: () => void;\n}\n\ninterface ToastData {\n  /** Secondary cancel/dismiss button */\n  cancel?: ToastAction;\n  /** Whether to show a close button on this specific toast */\n  closeButton?: boolean;\n  /** Whether the toast can be dismissed by swiping or clicking close */\n  dismissible?: boolean;\n  /** Custom render function for fully custom toasts */\n  render?: (id: string) => ReactNode;\n}\n\ninterface ToastOptions {\n  /** Primary action button */\n  action?: ToastAction;\n  /** Secondary cancel/dismiss button */\n  cancel?: ToastAction;\n  /** Show a close button on this specific toast */\n  closeButton?: boolean;\n  /** Description text shown below the title */\n  description?: ReactNode;\n  /** Whether the toast can be swiped away or closed. @default true */\n  dismissible?: boolean;\n  /** Duration in ms before auto-dismiss. `Infinity` keeps the toast open. */\n  duration?: number;\n  /** Pass an existing toast ID to update it in-place */\n  id?: string;\n  /** Callback when a toast auto-closes after its duration */\n  onAutoClose?: () => void;\n  /** Callback when a toast is manually dismissed */\n  onDismiss?: () => void;\n}\n\n// ---------------------------------------------------------------------------\n// Global toast manager\n// ---------------------------------------------------------------------------\n\nconst toastManager = Toast.createToastManager();\n\n// ---------------------------------------------------------------------------\n// Imperative toast API\n// ---------------------------------------------------------------------------\n\nfunction createToast(\n  title: ReactNode,\n  options?: ToastOptions,\n  type?: string\n): string {\n  const {\n    id,\n    description,\n    duration,\n    action,\n    cancel,\n    dismissible = true,\n    closeButton,\n    onAutoClose,\n    onDismiss,\n  } = options ?? {};\n\n  // Resolve timeout: loading toasts don't auto-dismiss by default.\n  // When updating an existing toast (id provided), reset to 5 000 ms unless\n  // the caller set an explicit duration.\n  let resolvedTimeout: number | undefined;\n  if (duration === Number.POSITIVE_INFINITY) {\n    resolvedTimeout = 0;\n  } else if (duration != null) {\n    resolvedTimeout = duration;\n  } else if (type === \"loading\") {\n    resolvedTimeout = 0;\n  } else if (id != null) {\n    resolvedTimeout = 5000;\n  }\n\n  const payload = {\n    title,\n    description,\n    type: type ?? \"default\",\n    timeout: resolvedTimeout,\n    onClose: onAutoClose ?? onDismiss,\n    actionProps: action\n      ? { children: action.label, onClick: action.onClick }\n      : undefined,\n    data: { cancel, dismissible, closeButton } satisfies ToastData,\n  };\n\n  if (id) {\n    toastManager.update(id, payload);\n    return id;\n  }\n\n  return toastManager.add(payload);\n}\n\n// --- Main callable + attached methods ---\n\nfunction toastFn(title: ReactNode, options?: ToastOptions): string {\n  return createToast(title, options);\n}\n\ntoastFn.success = (title: ReactNode, options?: ToastOptions) =>\n  createToast(title, options, \"success\");\n\ntoastFn.error = (title: ReactNode, options?: ToastOptions) =>\n  createToast(title, options, \"error\");\n\ntoastFn.warning = (title: ReactNode, options?: ToastOptions) =>\n  createToast(title, options, \"warning\");\n\ntoastFn.info = (title: ReactNode, options?: ToastOptions) =>\n  createToast(title, options, \"info\");\n\ntoastFn.loading = (title: ReactNode, options?: ToastOptions) =>\n  createToast(title, options, \"loading\");\n\n/**\n * Create a toast that tracks a promise through loading → success / error.\n *\n * String shortcuts are mapped to the toast **title** (matching Sonner's API).\n * Pass an object (`{ title, description, … }`) for richer control.\n */\ntoastFn.promise = <T,>(\n  promise: Promise<T>,\n  options: {\n    loading: ReactNode | Record<string, unknown>;\n    success: ReactNode | ((data: T) => ReactNode) | Record<string, unknown>;\n    error: ReactNode | ((error: Error) => ReactNode) | Record<string, unknown>;\n  }\n): Promise<T> => {\n  // Map shorthand string / ReactNode values to `{ title }` so the toast\n  // shows the text as its title (Sonner compat — Base UI defaults to\n  // `description` for string shortcuts).\n  const mapOption = (\n    opt: ReactNode | ((arg: never) => ReactNode) | Record<string, unknown>\n  ): unknown => {\n    if (typeof opt === \"function\") {\n      return (arg: unknown) => {\n        const result = (opt as (a: unknown) => ReactNode)(arg);\n        if (\n          typeof result === \"object\" &&\n          result !== null &&\n          !isValidElement(result)\n        ) {\n          return result; // Already a config object\n        }\n        return { title: result };\n      };\n    }\n    if (typeof opt === \"object\" && opt !== null && !isValidElement(opt)) {\n      return opt; // Already a config object\n    }\n    return { title: opt };\n  };\n\n  return toastManager.promise(promise, {\n    loading: mapOption(options.loading),\n    success: mapOption(options.success),\n    error: mapOption(options.error),\n  } as Parameters<typeof toastManager.promise>[1]);\n};\n\n/** Close and remove a toast by its ID. */\ntoastFn.dismiss = (id: string) => {\n  toastManager.close(id);\n};\n\n/** Create a fully custom toast with arbitrary JSX. */\ntoastFn.custom = (\n  render: (id: string) => ReactNode,\n  options?: Pick<ToastOptions, \"id\" | \"duration\" | \"dismissible\">\n): string => {\n  const { id, duration, dismissible = true } = options ?? {};\n\n  const payload = {\n    timeout: duration === Number.POSITIVE_INFINITY ? 0 : duration,\n    data: { render, dismissible } satisfies ToastData,\n  };\n\n  if (id) {\n    toastManager.update(id, payload);\n    return id;\n  }\n\n  return toastManager.add(payload);\n};\n\n/** Imperative toast API — call `toast(\"message\")` or use typed helpers. */\nconst toast = toastFn;\n\n// ---------------------------------------------------------------------------\n// Icons\n// ---------------------------------------------------------------------------\n\nconst TOAST_ICONS: Record<string, ReactNode> = {\n  success: <CircleCheckIcon className=\"size-4\" />,\n  info: <InfoIcon className=\"size-4\" />,\n  warning: <TriangleAlertIcon className=\"size-4\" />,\n  error: <OctagonXIcon className=\"size-4\" />,\n  loading: <Loader2Icon className=\"size-4 animate-spin\" />,\n};\n\n// ---------------------------------------------------------------------------\n// Semantic color classes (icon + title only, matching Alert palette)\n// ---------------------------------------------------------------------------\n\nconst TYPE_CLASSES: Record<string, string> = {\n  success:\n    \"[&_[data-slot=toast-icon]]:text-green-600 dark:[&_[data-slot=toast-icon]]:text-green-500 [&_[data-slot=toast-title]]:text-green-600 dark:[&_[data-slot=toast-title]]:text-green-500\",\n  error:\n    \"[&_[data-slot=toast-icon]]:text-red-600 dark:[&_[data-slot=toast-icon]]:text-red-500 [&_[data-slot=toast-title]]:text-red-600 dark:[&_[data-slot=toast-title]]:text-red-500\",\n  warning:\n    \"[&_[data-slot=toast-icon]]:text-yellow-600 dark:[&_[data-slot=toast-icon]]:text-yellow-500 [&_[data-slot=toast-title]]:text-yellow-600 dark:[&_[data-slot=toast-title]]:text-yellow-500\",\n  info: \"[&_[data-slot=toast-icon]]:text-blue-600 dark:[&_[data-slot=toast-icon]]:text-blue-500 [&_[data-slot=toast-title]]:text-blue-600 dark:[&_[data-slot=toast-title]]:text-blue-500\",\n};\n\n// ---------------------------------------------------------------------------\n// Viewport position mapping\n// ---------------------------------------------------------------------------\n\nconst VIEWPORT_POSITION_CLASSES: Record<ToastPosition, string> = {\n  \"top-left\": \"top-0 left-0\",\n  \"top-center\": \"top-0 left-1/2 -translate-x-1/2\",\n  \"top-right\": \"top-0 right-0\",\n  \"bottom-left\": \"bottom-0 left-0\",\n  \"bottom-center\": \"bottom-0 left-1/2 -translate-x-1/2\",\n  \"bottom-right\": \"bottom-0 right-0\",\n};\n\n// ---------------------------------------------------------------------------\n// Toast stacking classes (matching Base UI Toast example verbatim)\n// All stacking logic lives here as Tailwind utilities — no separate CSS file.\n// ---------------------------------------------------------------------------\n\n/** Position-independent stacking, animation, and transition classes. */\nconst TOAST_STACK_BASE = [\n  // CSS custom properties for stacking math\n  \"[--gap:0.75rem]\",\n  \"[--peek:0.75rem]\",\n  \"[--scale:calc(max(0,1-(var(--toast-index)*0.1)))]\",\n  \"[--shrink:calc(1-var(--scale))]\",\n  \"[--height:var(--toast-frontmost-height,var(--toast-height))]\",\n  // Absolute stacking\n  \"absolute w-full\",\n  \"z-[calc(1000-var(--toast-index))]\",\n  // Height: match frontmost when collapsed, own height when expanded\n  \"h-[var(--height)]\",\n  \"data-[expanded]:h-[var(--toast-height)]\",\n  // Transition\n  \"[transition:transform_0.5s_cubic-bezier(0.22,1,0.36,1),opacity_0.5s,height_0.15s]\",\n  \"data-[swiping]:[transition:none]\",\n  // Invisible gap below for hover continuity between stacked toasts\n  \"after:absolute after:top-full after:left-0 after:h-[calc(var(--gap)+1px)] after:w-full after:content-['']\",\n  // Expanded: fan out using --offset-y (computed per-position below)\n  \"data-[expanded]:[transform:translateX(var(--toast-swipe-movement-x))_translateY(var(--offset-y))]\",\n  // Fade on exit / exceed limit\n  \"data-[ending-style]:opacity-0\",\n  \"data-[limited]:opacity-0\",\n  // Swipe exit: down\n  \"data-[ending-style]:data-[swipe-direction=down]:[transform:translateY(calc(var(--toast-swipe-movement-y)+150%))]\",\n  \"data-[expanded]:data-[ending-style]:data-[swipe-direction=down]:[transform:translateY(calc(var(--toast-swipe-movement-y)+150%))]\",\n  // Swipe exit: up\n  \"data-[ending-style]:data-[swipe-direction=up]:[transform:translateY(calc(var(--toast-swipe-movement-y)-150%))]\",\n  \"data-[expanded]:data-[ending-style]:data-[swipe-direction=up]:[transform:translateY(calc(var(--toast-swipe-movement-y)-150%))]\",\n  // Swipe exit: left\n  \"data-[ending-style]:data-[swipe-direction=left]:[transform:translateX(calc(var(--toast-swipe-movement-x)-150%))_translateY(var(--offset-y))]\",\n  \"data-[expanded]:data-[ending-style]:data-[swipe-direction=left]:[transform:translateX(calc(var(--toast-swipe-movement-x)-150%))_translateY(var(--offset-y))]\",\n  // Swipe exit: right\n  \"data-[ending-style]:data-[swipe-direction=right]:[transform:translateX(calc(var(--toast-swipe-movement-x)+150%))_translateY(var(--offset-y))]\",\n  \"data-[expanded]:data-[ending-style]:data-[swipe-direction=right]:[transform:translateX(calc(var(--toast-swipe-movement-x)+150%))_translateY(var(--offset-y))]\",\n];\n\n/** Bottom position: anchor to bottom edge, peek upward. */\nconst TOAST_BOTTOM_CLASSES = [\n  \"[--offset-y:calc(var(--toast-offset-y)*-1+calc(var(--toast-index)*var(--gap)*-1)+var(--toast-swipe-movement-y))]\",\n  \"bottom-0 origin-bottom\",\n  \"[transform:translateX(var(--toast-swipe-movement-x))_translateY(calc(var(--toast-swipe-movement-y)-(var(--toast-index)*var(--peek))-(var(--shrink)*var(--height))))_scale(var(--scale))]\",\n  \"data-[starting-style]:[transform:translateY(150%)]\",\n  \"[&[data-ending-style]:not([data-limited]):not([data-swipe-direction])]:[transform:translateY(150%)]\",\n];\n\n/** Top position: anchor to top edge, peek downward. */\nconst TOAST_TOP_CLASSES = [\n  \"[--offset-y:calc(var(--toast-offset-y)+calc(var(--toast-index)*var(--gap))+var(--toast-swipe-movement-y))]\",\n  \"top-0 origin-top\",\n  \"[transform:translateX(var(--toast-swipe-movement-x))_translateY(calc(var(--toast-swipe-movement-y)+(var(--toast-index)*var(--peek))+(var(--shrink)*var(--height))))_scale(var(--scale))]\",\n  \"data-[starting-style]:[transform:translateY(-150%)]\",\n  \"[&[data-ending-style]:not([data-limited]):not([data-swipe-direction])]:[transform:translateY(-150%)]\",\n];\n\n/** Content classes: height clipping for varying heights + behind/expanded opacity. */\nconst TOAST_CONTENT_CLASSES = [\n  \"h-full overflow-hidden\",\n  \"transition-opacity [transition-duration:250ms]\",\n  \"data-[behind]:pointer-events-none data-[behind]:opacity-0\",\n  \"data-[expanded]:pointer-events-auto data-[expanded]:opacity-100\",\n];\n\n// ---------------------------------------------------------------------------\n// ToastList (internal — rendered inside Toast.Provider)\n// ---------------------------------------------------------------------------\n\nfunction ToastList({\n  closeButton,\n  isTop,\n}: {\n  closeButton?: boolean;\n  isTop: boolean;\n}) {\n  const { toasts } = Toast.useToastManager();\n\n  return toasts.map((t) => (\n    <ToastItem closeButton={closeButton} isTop={isTop} key={t.id} toast={t} />\n  ));\n}\n\n// ---------------------------------------------------------------------------\n// ToastItem (internal)\n// ---------------------------------------------------------------------------\n\nfunction ToastItem({\n  toast: t,\n  closeButton: globalCloseButton,\n  isTop,\n}: {\n  toast: ReturnType<typeof Toast.useToastManager>[\"toasts\"][number];\n  closeButton?: boolean;\n  isTop: boolean;\n}) {\n  const data = (t.data ?? {}) as ToastData;\n  const positionClasses = isTop ? TOAST_TOP_CLASSES : TOAST_BOTTOM_CLASSES;\n\n  // ---- Custom render ----\n  if (data.render) {\n    return (\n      <Toast.Root\n        className={cn(\n          TOAST_STACK_BASE,\n          positionClasses,\n          \"pointer-events-auto select-none bg-clip-padding\"\n        )}\n        swipeDirection={data.dismissible === false ? [] : [\"down\", \"right\"]}\n        toast={t}\n      >\n        <Toast.Content className={cn(TOAST_CONTENT_CLASSES)}>\n          {data.render(t.id)}\n        </Toast.Content>\n      </Toast.Root>\n    );\n  }\n\n  // ---- Standard render ----\n  const icon = t.type && t.type !== \"default\" ? TOAST_ICONS[t.type] : undefined;\n  const typeClass = t.type ? TYPE_CLASSES[t.type] : undefined;\n  const showCloseButton = data.closeButton ?? globalCloseButton ?? true;\n  const isDismissible = data.dismissible !== false;\n\n  return (\n    <Toast.Root\n      className={cn(\n        // Stacking & animation (from Base UI example)\n        TOAST_STACK_BASE,\n        positionClasses,\n        // Layout\n        \"group/toast pointer-events-auto\",\n        // Appearance\n        \"select-none rounded-lg border border-border-muted bg-popover bg-clip-padding text-popover-foreground shadow-lg\",\n        // Semantic type colors\n        typeClass\n      )}\n      data-slot=\"toast\"\n      swipeDirection={isDismissible ? [\"down\", \"right\"] : []}\n      toast={t}\n    >\n      <Toast.Content\n        className={cn(\n          // Stacking: height clipping + behind/expanded opacity\n          TOAST_CONTENT_CLASSES,\n          \"flex w-full gap-2 p-3\",\n          // Mobile: wrap action buttons below content\n          \"max-sm:flex-wrap\"\n        )}\n        data-slot=\"toast-content\"\n      >\n        {icon && (\n          <div className=\"mt-0.5 shrink-0\" data-slot=\"toast-icon\">\n            {icon}\n          </div>\n        )}\n\n        <div\n          className={cn(\n            \"flex min-w-0 flex-1 flex-col gap-0.5\",\n            // Mobile with icon: ensure text block fills the row\n            \"max-sm:flex-[1_0_calc(100%-2rem)]\"\n          )}\n          data-slot=\"toast-text\"\n        >\n          {t.title != null && (\n            <Toast.Title\n              className=\"font-medium text-sm leading-snug\"\n              data-slot=\"toast-title\"\n            />\n          )}\n          {t.description != null && (\n            <Toast.Description\n              className=\"text-muted-foreground text-xs leading-snug\"\n              data-slot=\"toast-description\"\n            />\n          )}\n        </div>\n\n        {/* Action buttons */}\n        {(t.actionProps || data.cancel) && (\n          <div\n            className={cn(\n              \"flex shrink-0 items-center gap-1.5\",\n              // Mobile: full width row below the text\n              \"max-sm:mt-1 max-sm:ml-0\",\n              icon ? \"max-sm:ml-6\" : undefined\n            )}\n            data-slot=\"toast-actions\"\n          >\n            {data.cancel && (\n              <button\n                className=\"inline-flex h-7 cursor-pointer items-center justify-center rounded-md px-2.5 font-medium text-muted-foreground text-xs transition-colors hover:bg-accent hover:text-accent-foreground\"\n                data-slot=\"toast-cancel\"\n                onClick={() => {\n                  data.cancel?.onClick?.();\n                  toastManager.close(t.id);\n                }}\n                type=\"button\"\n              >\n                {data.cancel.label}\n              </button>\n            )}\n            {t.actionProps && (\n              <Toast.Action\n                className=\"inline-flex h-7 cursor-pointer items-center justify-center rounded-md border border-border bg-background px-2.5 font-medium text-xs transition-colors hover:bg-accent hover:text-accent-foreground\"\n                data-slot=\"toast-action\"\n              />\n            )}\n          </div>\n        )}\n      </Toast.Content>\n\n      {/* Close button — round pill at the top-right corner */}\n      {showCloseButton && isDismissible && (\n        <Toast.Close\n          aria-label=\"Close\"\n          className={cn(\n            // Position: centered on the top-right corner of the toast\n            \"absolute top-0 right-0 translate-x-1/2 -translate-y-1/2\",\n            // Size 20×20, circular\n            \"flex size-5 items-center justify-center rounded-full border border-border p-0 shadow-sm\",\n            // Colors: subtle background like ghost button\n            \"bg-background text-muted-foreground\",\n            \"hover:bg-accent hover:text-foreground\",\n            // Hidden by default, revealed on toast hover\n            \"opacity-0 group-hover/toast:opacity-100\",\n            // Also reveal on keyboard focus for a11y\n            \"focus-visible:opacity-100\",\n            // Smooth transitions for reveal + hover background\n            \"cursor-pointer transition-[opacity,background-color,color]\",\n            // Mobile: always visible (no hover on touch)\n            \"max-sm:opacity-100\"\n          )}\n          data-slot=\"toast-close\"\n        >\n          <XIcon className=\"size-3\" />\n        </Toast.Close>\n      )}\n    </Toast.Root>\n  );\n}\n\n// ---------------------------------------------------------------------------\n// Toaster\n// ---------------------------------------------------------------------------\n\nexport interface ToasterProps {\n  /** Additional CSS class for the viewport container */\n  className?: string;\n  /** Show a close (×) button on every toast. @default true */\n  closeButton?: boolean;\n  /** Default auto-dismiss timeout in ms. @default 5000 */\n  duration?: number;\n  /** Maximum number of visible toasts. @default 3 */\n  limit?: number;\n  /** Where toasts appear on screen. @default \"bottom-right\" */\n  position?: ToastPosition;\n}\n\nfunction Toaster({\n  position = \"bottom-right\",\n  duration = 5000,\n  limit = 3,\n  closeButton = true,\n  className,\n}: ToasterProps) {\n  const isTop = position.startsWith(\"top\");\n\n  return (\n    <Toast.Provider\n      limit={limit}\n      timeout={duration}\n      toastManager={toastManager}\n    >\n      <Toast.Portal>\n        <Toast.Viewport\n          className={cn(\n            \"fixed z-[100] m-4 outline-none\",\n            // Width: fixed on desktop, full on mobile\n            \"w-(--width) max-sm:right-0 max-sm:left-0 max-sm:mx-2 max-sm:w-auto\",\n            // Position-specific\n            VIEWPORT_POSITION_CLASSES[position],\n            className\n          )}\n          data-position={isTop ? \"top\" : \"bottom\"}\n          data-slot=\"toaster\"\n          style={{ \"--width\": \"356px\" } as CSSProperties}\n        >\n          <ToastList closeButton={closeButton} isTop={isTop} />\n        </Toast.Viewport>\n      </Toast.Portal>\n    </Toast.Provider>\n  );\n}\n\nToaster.displayName = \"Toaster\";\n\n// ---------------------------------------------------------------------------\n// Exports\n// ---------------------------------------------------------------------------\n\nexport { Toaster, toast };\nexport type { ToastOptions, ToastPosition, ToastAction, ToastData };\n",
      "type": "registry:ui"
    }
  ],
  "type": "registry:ui"
}
